// Copyright 2021 Zenauth Ltd.
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package cerbos.schema.v1;

import "protoc-gen-openapiv2/options/openapiv2.proto";
import "validate/validate.proto";

option go_package = "github.com/cerbos/cerbos/api/genpb/cerbos/schema/v1;schemav1";
option java_package = "dev.cerbos.api.v1.schema";
option csharp_namespace = "Cerbos.Api.V1.Schema";

message Schema {
  string api_version = 1 [(validate.rules).string.const = "api.cerbos.dev/v1"];
  string schema_version = 2 [(validate.rules).string.pattern = "^[[:word:]]+$"];
  bool disabled = 3;
  string description = 4;
  PrincipalSchema principle_schema = 5;
  ResourceSchema resource_schema = 6;
}

message PrincipalSchema {
  map<string, SchemaDef> schemas = 1;
}

message ResourceSchema {
  map<string, SchemaDef> schemas = 1;
}

message SchemaDef {
  grpc.gateway.protoc_gen_openapiv2.options.Schema schema = 1;
  map<string, grpc.gateway.protoc_gen_openapiv2.options.Header> headers = 2;
}
