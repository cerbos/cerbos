table:
  name: One-dimensional table test
  description: A test for multiple principals and a single resource, with aux data.
  input:
    principals:
      - employee
      - manager
      - department_head
    resource: manager_leave_request
    actions:
      - view
      - approve
    auxData: test_aux_data
  expected:
    - principal: manager
      actions:
        view: EFFECT_ALLOW
        approve: EFFECT_DENY
    - principal: department_head
      actions:
        view: EFFECT_ALLOW
        approve: EFFECT_ALLOW

wantTests:
  - name:
      testTableName: One-dimensional table test
      principalKey: employee
      resourceKey: manager_leave_request
    description: A test for multiple principals and a single resource, with aux data.
    input:
      principal:
        id: user:employee
      resource:
        id: leave_request:manager
      actions:
        - view
        - approve
      auxData:
        jwt:
          answer: 42
    expected:
      view: EFFECT_DENY
      approve: EFFECT_DENY
  - name:
      testTableName: One-dimensional table test
      principalKey: manager
      resourceKey: manager_leave_request
    description: A test for multiple principals and a single resource, with aux data.
    input:
      principal:
        id: user:manager
      resource:
        id: leave_request:manager
      actions:
        - view
        - approve
      auxData:
        jwt:
          answer: 42
    expected:
      view: EFFECT_ALLOW
      approve: EFFECT_DENY
  - name:
      testTableName: One-dimensional table test
      principalKey: department_head
      resourceKey: manager_leave_request
    description: A test for multiple principals and a single resource, with aux data.
    input:
      principal:
        id: user:department_head
      resource:
        id: leave_request:manager
      actions:
        - view
        - approve
      auxData:
        jwt:
          answer: 42
    expected:
      view: EFFECT_ALLOW
      approve: EFFECT_ALLOW
