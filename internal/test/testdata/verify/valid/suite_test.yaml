---
name: TestSuite
description: Tests for verifying something
options:
  now: "2022-08-02T15:00:00Z"
tests:
  - name: John and his leave request
    input:
      principals:
        - john
      resources:
        - john_leave_request
      actions:
        - view:public
        - approve
        - defer
      auxData: myJWT
    expected:
      - principal: john
        resource: john_leave_request
        actions:
          view:public: EFFECT_ALLOW
          approve: EFFECT_DENY
          defer: EFFECT_ALLOW

  - name: With global now
    input:
      principals:
        - bev
      resources:
        - stale_leave_request
      actions:
        - remind
      auxData: myJWT
    expected:
      - principal: bev
        resource: stale_leave_request
        actions:
          remind: EFFECT_ALLOW

  - name: With local now
    options:
      now: "2022-08-03T15:00:00Z"
    input:
      principals:
        - bev
      resources:
        - stale_pending_leave_request
      actions:
        - remind
      auxData: myJWT
    expected:
      - principal: bev
        resource: stale_pending_leave_request
        actions:
          remind: EFFECT_DENY
