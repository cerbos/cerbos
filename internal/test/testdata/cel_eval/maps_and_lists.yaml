---
condition:
  all:
    of:
      - expr: |-
          "design" in request.principal.attr.teams
      - expr: |-
          "acme" in request.principal.attr.clients
      - expr: |-
          request.principal.attr.teams[0] == "design"
      - expr: |-
          request.principal.attr.clients["acme"]["active"] == true
      - expr: |-
          size(request.principal.attr.teams) == 3
      - expr: |-
          size(request.principal.attr.clients) == 2

input: {
  "requestId": "test",
  "actions": ["*"],
  "principal": {
    "id": "john",
    "roles": ["employee"],
    "attr": {
      "department": "marketing",
      "teams": ["design", "communications", "product"],
      "clients": {
        "acme": {"active": true},
        "bb inc": {"active": true}
      }
    }
  },
  "resource": {
    "name": "leave_request",
    "attr": {
      "owner": "john"
    }
  }
}
want: true
