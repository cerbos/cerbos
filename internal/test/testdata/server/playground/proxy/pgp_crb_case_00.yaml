---
description: "Valid CheckResourceBatch request"
wantStatus:
  httpStatusCode: 200
  grpcStatusCode: 0
playgroundProxy:
  input: {
    "playgroundId": "test",
    "policyFiles": [
      {
        "fileName": "common_roles.yaml",
        "contents": "LS0tCmFwaVZlcnNpb246ICJhcGkuY2VyYm9zLmRldi92MSIKZGVyaXZlZFJvbGVzOgogIG5hbWU6IG15X2Rlcml2ZWRfcm9sZXMKICBkZWZpbml0aW9uczoKICAgIC0gbmFtZTogYWRtaW4KICAgICAgcGFyZW50Um9sZXM6IFsiYWRtaW4iXQoKICAgIC0gbmFtZTogdGVzdGVyCiAgICAgIHBhcmVudFJvbGVzOiBbImRldiIsICJxYSJdCgogICAgLSBuYW1lOiBlbXBsb3llZV90aGF0X293bnNfdGhlX3JlY29yZAogICAgICBwYXJlbnRSb2xlczogWyJlbXBsb3llZSJdCiAgICAgIGNvbmRpdGlvbjoKICAgICAgICBzY3JpcHQ6IHwtCiAgICAgICAgICBpbnB1dC5yZXNvdXJjZS5hdHRyLm93bmVyID09IGlucHV0LnByaW5jaXBhbC5pZAoKICAgIC0gbmFtZTogYW55X2VtcGxveWVlCiAgICAgIHBhcmVudFJvbGVzOiBbImVtcGxveWVlIl0KCiAgICAtIG5hbWU6IGRpcmVjdF9tYW5hZ2VyCiAgICAgIHBhcmVudFJvbGVzOiBbIm1hbmFnZXIiXQogICAgICBjb25kaXRpb246CiAgICAgICAgbWF0Y2g6CiAgICAgICAgICBhbGw6CiAgICAgICAgICAgIG9mOgogICAgICAgICAgICAgIC0gZXhwcjogInJlcXVlc3QucmVzb3VyY2UuYXR0ci5nZW9ncmFwaHkgPT0gcmVxdWVzdC5wcmluY2lwYWwuYXR0ci5nZW9ncmFwaHkiCiAgICAgICAgICAgICAgLSBleHByOiAicmVxdWVzdC5yZXNvdXJjZS5hdHRyLmdlb2dyYXBoeSA9PSByZXF1ZXN0LnByaW5jaXBhbC5hdHRyLm1hbmFnZWRfZ2VvZ3JhcGhpZXMiCg=="
      },
      {
        "fileName": "resource.yaml",
        "contents": "LS0tCmFwaVZlcnNpb246IGFwaS5jZXJib3MuZGV2L3YxCnJlc291cmNlUG9saWN5OgogIGltcG9ydERlcml2ZWRSb2xlczoKICAtIG15X2Rlcml2ZWRfcm9sZXMKICByZXNvdXJjZTogbGVhdmVfcmVxdWVzdAogIHJ1bGVzOgogIC0gYWN0aW9uczogWycqJ10KICAgIGVmZmVjdDogRUZGRUNUX0FMTE9XCiAgICByb2xlczoKICAgIC0gYWRtaW4KICAtIGFjdGlvbnM6IFsiY3JlYXRlIl0KICAgIGRlcml2ZWRSb2xlczoKICAgIC0gZW1wbG95ZWVfdGhhdF9vd25zX3RoZV9yZWNvcmQKICAgIGVmZmVjdDogRUZGRUNUX0FMTE9XCiAgLSBhY3Rpb25zOiBbInZpZXc6KiJdCiAgICBkZXJpdmVkUm9sZXM6CiAgICAtIGVtcGxveWVlX3RoYXRfb3duc190aGVfcmVjb3JkCiAgICAtIGRpcmVjdF9tYW5hZ2VyCiAgICBlZmZlY3Q6IEVGRkVDVF9BTExPVwogIC0gYWN0aW9uczogWyJ2aWV3OnB1YmxpYyJdCiAgICBkZXJpdmVkUm9sZXM6CiAgICAtIGFueV9lbXBsb3llZQogICAgZWZmZWN0OiBFRkZFQ1RfQUxMT1cKICAtIGFjdGlvbnM6IFsiYXBwcm92ZSJdCiAgICBjb25kaXRpb246CiAgICAgIG1hdGNoOgogICAgICAgIGV4cHI6IHJlcXVlc3QucmVzb3VyY2UuYXR0ci5zdGF0dXMgPT0gIlBFTkRJTkdfQVBQUk9WQUwiCiAgICBkZXJpdmVkUm9sZXM6CiAgICAtIGRpcmVjdF9tYW5hZ2VyCiAgICBlZmZlY3Q6IEVGRkVDVF9BTExPVwogIHZlcnNpb246ICIyMDIxMDIxMCIK"
      },
      {
        "fileName": "principal.yaml",
        "contents": "LS0tCmFwaVZlcnNpb246ICJhcGkuY2VyYm9zLmRldi92MSIKcHJpbmNpcGFsUG9saWN5OgogIHByaW5jaXBhbDogZG9uYWxkX2R1Y2sKICB2ZXJzaW9uOiAiMjAyMTAyMTAiCiAgcnVsZXM6CiAgICAtIHJlc291cmNlOiBsZWF2ZV9yZXF1ZXN0CiAgICAgIGFjdGlvbnM6CiAgICAgICAgLSBhY3Rpb246ICIqIgogICAgICAgICAgY29uZGl0aW9uOgogICAgICAgICAgICBtYXRjaDoKICAgICAgICAgICAgICBleHByOiAicmVxdWVzdC5yZXNvdXJjZS5hdHRyLmRldl9yZWNvcmQgPT0gdHJ1ZSIKICAgICAgICAgIGVmZmVjdDogRUZGRUNUX0FMTE9XCgogICAgLSByZXNvdXJjZTogc2FsYXJ5X3JlY29yZAogICAgICBhY3Rpb25zOgogICAgICAgIC0gYWN0aW9uOiAiKiIKICAgICAgICAgIGVmZmVjdDogRUZGRUNUX0RFTlkK"
      }
    ],
    "checkResourceBatch": {
      "requestId": "test",
      "principal": {
        "id": "john",
        "policyVersion": "20210210",
        "roles": [
          "employee"
        ],
        "attr": {
          "department": "marketing",
          "geography": "GB",
          "team": "design"
        }
      },
      "resources": [
        {
          "actions": [
            "view:public",
            "approve"
          ],
          "resource": {
            "kind": "leave_request",
            "policyVersion": "20210210",
            "id": "XX125",
            "attr": {
              "department": "marketing",
              "geography": "GB",
              "id": "XX125",
              "owner": "john",
              "team": "design"
            }
          }
        },
        {
          "actions": [
            "view:public",
            "approve"
          ],
          "resource": {
            "kind": "leave_request",
            "policyVersion": "20210210",
            "id": "YY125",
            "attr": {
              "department": "engineering",
              "geography": "GB",
              "id": "YY125",
              "owner": "jenny",
              "team": "backend"
            }
          }
        },
        {
          "actions": [
            "view:public",
            "delete",
            "edit"
          ],
          "resource": {
            "kind": "salary_record",
            "policyVersion": "20210210",
            "id": "YY525",
            "attr": {
              "department": "engineering",
              "geography": "GB",
              "id": "YY525",
              "owner": "mark",
              "team": "backend"
            }
          }
        }
      ]
    }
  }
  wantResponse: {
    "playgroundId": "test",
    "checkResourceBatch": {
      "requestId": "test",
      "results": [
        {
          "resourceId": "XX125",
          "actions": {
            "view:public": "EFFECT_ALLOW",
            "approve": "EFFECT_DENY"
          }
        },
        {
          "resourceId": "YY125",
          "actions": {
            "view:public": "EFFECT_ALLOW",
            "approve": "EFFECT_DENY"
          }
        },
        {
          "resourceId": "YY525",
          "actions": {
            "view:public": "EFFECT_DENY",
            "delete": "EFFECT_DENY",
            "edit": "EFFECT_DENY"
          }
        }
      ]
    }
  }
