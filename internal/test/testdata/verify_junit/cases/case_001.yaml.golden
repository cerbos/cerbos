<testsuites errors="0" failures="4" skipped="0" tests="4">
  <testsuite description="Tests for verifying the company resource policy" name="CompanyTestSuite" file="suite_test.yaml" errors="0" failures="4" skipped="0" tests="4">
    <properties>
      <property name="step[Company Test 1 - admin.company.create]">
        <traces>
          <trace id="1">
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-001</rule>
            <message>No matching roles or derived roles</message>
            <skipped>true</skipped>
          </trace>
          <trace id="2">
            <condition>KIND_CONDITION</condition>
            <action>create</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-002</rule>
            <result>true</result>
            <activated>true</activated>
          </trace>
          <trace id="3">
            <action>create</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-002</rule>
            <effect>EFFECT_ALLOW</effect>
            <activated>true</activated>
          </trace>
        </traces>
      </property>
      <property name="step[Company Test 1 - admin.company.read]">
        <traces>
          <trace id="1">
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-001</rule>
            <message>No matching roles or derived roles</message>
            <skipped>true</skipped>
          </trace>
          <trace id="2">
            <condition>KIND_CONDITION</condition>
            <action>read</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-002</rule>
            <result>true</result>
            <activated>true</activated>
          </trace>
          <trace id="3">
            <action>read</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-002</rule>
            <effect>EFFECT_ALLOW</effect>
            <activated>true</activated>
          </trace>
        </traces>
      </property>
      <property name="step[Company Test 2 - user.company.create]">
        <traces>
          <trace id="1">
            <condition>KIND_CONDITION</condition>
            <action>create</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-001</rule>
            <result>true</result>
            <activated>true</activated>
          </trace>
          <trace id="2">
            <action>create</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-001</rule>
            <effect>EFFECT_ALLOW</effect>
            <activated>true</activated>
          </trace>
          <trace id="3">
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-002</rule>
            <message>No matching roles or derived roles</message>
            <skipped>true</skipped>
          </trace>
        </traces>
      </property>
      <property name="step[Company Test 2 - user.company.read]">
        <traces>
          <trace id="1">
            <condition>KIND_CONDITION</condition>
            <action>read</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-001</rule>
            <result>true</result>
            <activated>true</activated>
          </trace>
          <trace id="2">
            <action>read</action>
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-001</rule>
            <effect>EFFECT_ALLOW</effect>
            <activated>true</activated>
          </trace>
          <trace id="3">
            <policy>cerbos.resource.company.vdefault</policy>
            <rule>rule-002</rule>
            <message>No matching roles or derived roles</message>
            <skipped>true</skipped>
          </trace>
        </traces>
      </property>
    </properties>
    <testcase file="suite_test.yaml" classname="admin.company.create" name="Company Test 1">
      <failure type="RESULT_FAILED">
        <actual>EFFECT_ALLOW</actual>
        <expected>EFFECT_DENY</expected>
      </failure>
      <properties></properties>
    </testcase>
    <testcase file="suite_test.yaml" classname="admin.company.read" name="Company Test 1">
      <failure type="RESULT_FAILED">
        <actual>EFFECT_ALLOW</actual>
        <expected>EFFECT_DENY</expected>
      </failure>
      <properties></properties>
    </testcase>
    <testcase file="suite_test.yaml" classname="user.company.create" name="Company Test 2">
      <failure type="RESULT_FAILED">
        <actual>EFFECT_ALLOW</actual>
        <expected>EFFECT_DENY</expected>
      </failure>
      <properties></properties>
    </testcase>
    <testcase file="suite_test.yaml" classname="user.company.read" name="Company Test 2">
      <failure type="RESULT_FAILED">
        <actual>EFFECT_ALLOW</actual>
        <expected>EFFECT_DENY</expected>
      </failure>
      <properties></properties>
    </testcase>
  </testsuite>
</testsuites>