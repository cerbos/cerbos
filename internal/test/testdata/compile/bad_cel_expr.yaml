---
wantErrors:
  - "principal_policies/donald_duck_20210210.yaml: Failed to compile condition for rule 'leave_request_rule-001' (#2) of resource 'leave_request' (Invalid match expression: Syntax error: token recognition error at: '^',Invalid match expression: Syntax error: token recognition error at: '^',Invalid match expression: Syntax error: extraneous input 'true' expecting <EOF>)"
mainDef: "principal_policies/donald_duck_20210210.yaml"
inputDefs:
  "principal_policies/donald_duck_20210210.yaml":
    apiVersion: "api.cerbos.dev/v1"
    principalPolicy:
      principal: donald_duck
      version: "20210210"
      rules:
        - resource: leave_request
          actions:
            - action: "*"
              condition:
                match:
                  expr: "resource.attr.dev_record ^^ true"
              effect: EFFECT_ALLOW

        - resource: salary_record
          actions:
            - action: "*"
              effect: EFFECT_DENY
