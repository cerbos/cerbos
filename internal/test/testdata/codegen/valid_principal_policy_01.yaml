---
inputPolicy:
  apiVersion: "api.cerbos.dev/v1"
  principalPolicy:
    principal: donald_duck
    version: "20210210"
    rules:
      - resource: leave_request
        actions:
          - action: "*"
            condition:
              match:
                expr: "request.resource.attr.dev_record == true"
            effect: EFFECT_ALLOW

      - resource: salary_record
        actions:
          - action: "*"
            effect: EFFECT_DENY

wantRego: |-
  package cerbos.principal.donald_duck.v20210210

  default effect = "no_match"

  effect = "allow" {
      glob.match("leave_request", [":"], input.resource.name)
      glob.match("*", [], input.action)
      cel_eval(input, "cerbos.principal.donald_duck.v20210210", "cond_0")
  }

  effect = "deny" {
      glob.match("salary_record", [":"], input.resource.name)
      glob.match("*", [], input.action)
  }

wantNumConditions: 1
