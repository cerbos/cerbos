# yaml-language-server: $schema=../../../../../../schema/jsonschema/cerbos/policy/v1/Policy.schema.json
---
apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: default
  resource: two-var-compre
  rules:
    - actions:
        - all
      effect: EFFECT_ALLOW
      roles:
        - employee
      condition:
        match:
          expr: R.attr.deps.all(k, v, k != v)
    - actions:
        - exists
      effect: EFFECT_ALLOW
      roles:
        - employee
      condition:
        match:
          expr: R.attr.deps.exists(k, v, k != v)
    - actions:
        - exists_one
      effect: EFFECT_ALLOW
      roles:
        - employee
      condition:
        match:
          expr: R.attr.deps.exists_one(k, v, k != v)
    - actions:
        - filter
      effect: EFFECT_ALLOW
      roles:
        - employee
      condition:
        match:
          expr: R.attr.deps.filter(k, v, k != v)
